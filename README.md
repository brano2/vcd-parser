# VCD (Value Change Dump) Parser

Basic (and incomplete) parser for Value Change Dump (`.vcd`) files. Developed
primarily to read files generated by
[PulseView](https://sigrok.org/wiki/PulseView) logic analyser software.

If you got your VCD file from Verilog, [vcdvcd](https://pypi.org/project/vcdvcd/)
or [Verilog_VCD](https://pypi.org/project/Verilog_VCD/) might work better.
(Neither worked for my VCD files.) For writing VCD files,
[pyvcd](https://pypi.org/project/pyvcd/) seems like a good option. The
[pymergevcd](https://pypi.org/project/pymergevcd/) package could also be worth
looking at.

## Features

* Parse all the VCD header information
* Parse basic value changes

## Limitations

* Simulation keywords (`$dumpall`, `$dumpon`, `$dumpoff`, `$dumpvars`) will
  currently crash the parser
* Only single-bit binary variables are supported
* The `x` and `z` variable values are not supported
* No special treatment for variable and scope types (the information is parsed
  and stored however, so it can be interpreted later)
* Whitespace in `$comment` and `$version` sections is not preserved (any
  sequence of whitespace characters is replaced by a single space)
* The _system task_ part of the `$version` section is not recognised and
  everything is treated as continuous text

## Usage

```py
from vcd_parser import VCD

# Open the file and parse its contents
vcd1 = VCD('bbb_pulses-10k-1M_PPM.vcd')

# Display the parsed data
print('VCD header data:')
print('\tComments:')
for comment in vcd1.comments:
    print('\t\t' + comment)
print('\tDate: ' + vcd1.date.isoformat())
print('\tVersion: ' + vcd1.version)
print(f'\tTimescale: {vcd1.timescale}s')
print()
print('Variables and value changes:')
for v in vcd1.vars.values():
    var = v.copy()
    del var['vals']
    del var['timestamps']
    var['num_vals'] = len(v['vals'])
    var['num_timestamps'] = len(v['timestamps'])
    print(var)
```

Running [the code above](demo/demo.py) should produce the following output:

```txt
VCD header data:
        Comments:
                Acquisition with 2/8 channels at 24 MHz
        Date: 2020-09-05T08:36:33
        Version: libsigrok 0.5.0
        Timescale: 1e-09s

Variables and value changes:
{'scope_type': 'module', 'scope': 'libsigrok', 'type': 'wire', 'size': 1, 'id': '!', 'name': 'pin', 'num_vals': 20002, 'num_timestamps': 20002}
{'scope_type': 'module', 'scope': 'libsigrok', 'type': 'wire', 'size': 1, 'id': '"', 'name': 'dbg_pin', 'num_vals': 4, 'num_timestamps': 4}
```
